#include "malware_http_spammer.h"


void MalwareHttpRequestSender::run() {
    sendRequest();
}


MalwareHttpRequestSender::MalwareHttpRequestSender(QObject* parent) : QThread(parent) {
    manager = new QNetworkAccessManager(this);
    connect(manager, &QNetworkAccessManager::finished, this, &MalwareHttpRequestSender::handleResponse);
}


void MalwareHttpRequestSender::sendRequest() {
    QUrl url("http://google.com");
    QNetworkRequest request(url);
    request.setTransferTimeout(5000); // таймаут в 5 секунд

    // генерация случайной информационной части
    const QString possibleCharacters = "0123456789abcdef";
    QString randomInfo;
    for (int i = 0; i < 32; ++i) {
        randomInfo += possibleCharacters[QRandomGenerator::global()->generate() % possibleCharacters.length()];
    }

    // отправка запроса
    manager->get(request);

    // отправка следующего запроса через 1 секунду
    QTimer::singleShot(1000, this, &MalwareHttpRequestSender::sendRequest);
}


void MalwareHttpRequestSender::handleResponse(QNetworkReply* reply) {
    Q_UNUSED(reply);
    return;
}
